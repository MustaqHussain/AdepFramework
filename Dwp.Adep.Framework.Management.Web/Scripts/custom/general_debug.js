/* 
DO NOT EDIT THIS FILE 
Use this for debugging only. You will need to change Layout.cshtml file to point at this one.
v2.1
*/
$(document).ready(function () {
    $.ajaxSetup({
        cache: false
    });
    initInputs();
    jQueryUIInit();
    restyleDropDown($('select:not(.notdropdown):not([name^="OperationalReportViewer"])'));
    redrawGrid();
});

$(window).load(function () {
    setWidthEqualToDiv('.webgrid-title', '.webgrid');
})


/* 	-----------------------------------
--  Form methods	 			 --  
-----------------------------------*/
function initInputs() {

    $('input[data-val-required][type="text"]').each(function (index, e) {
        addRequired(e);
    });

    $('input[data-val-mvcvtkrequiredif][type="text"]').each(function (index, e) {
        addRequired(e);
    });

    $('input[data-val-required][type="radio"]').each(function (index, e) {
        addRequired(e);
    });

    $('input[data-val-required][type="hidden"]').each(function (index, e) {
        addRequired(e);
    });

    $('select[data-val-required]').each(function (index, e) {
        addRequired(e);
    });

    $('textarea[data-val-required]').each(function (index, e) {
        addRequired(e);
    });

    $('select.input-validation-error').each(function () {
        restyleErrorDropDowns($(this)[0])
    });
}

function addRequired(e) {
    var elementid = e.id;
    var label = $('label[for =' + elementid + ']');
    $('<span class="required-input"> * </span>').insertAfter(label);
};

function restyleDropDown(e) {
    e.selectmenu({ style: 'dropdown' });
    e.change(function (e1) {
        id = e1.delegateTarget.id;
        var form = $('form');
        if (!form.validate().element(e1.delegateTarget)) {

            $('#' + id + '-button').addClass("ui-state-error")
        }
        else {
            $('#' + id + '-button').removeClass("ui-state-error")
        }
    });
};

function restyleErrorDropDowns(e) {
    var id = e.id;
    $('#' + id + '-button').addClass("ui-state-error");
};

function disableFormElement(elementName) {
    $(elementName).attr('disabled', 'disabled');
}

function enableFormElement(elementName) {
    $(elementName).removeAttr('disabled');
}

/* 	-----------------------------------
--  Page resize handling methods --  
-----------------------------------*/

var winWidth = $(window).width(), winHeight = $(window).height();

$(window).resize(function () {
    onResize = function () {
        windowResizeActions();
    };

    var winNewWidth = $(window).width(),
    winNewHeight = $(window).height();
    var resizeTimeout = null;

    if (winWidth != winNewWidth || winHeight != winNewHeight) {
        window.clearTimeout(resizeTimeout);
        resizeTimeout = window.setTimeout(onResize, 500);
    }
    winWidth = winNewWidth;
    winHeight = winNewHeight;
})

function windowResizeActions() {
    setWidthEqualToDiv('.webgrid-title', '.webgrid');
    redrawSelectMenus();
    redrawGrid();
}


function redrawGrid() {
    if ($.browser.msie && $.browser.version == "6.0") {
        try {
            var marginLeft = $($('.gridItem')[0]).css("margin-left");
            $('.gridItem').css("margin-left", marginLeft);
        }
        catch (e) {

        }
    }
}

function setWidthEqualToDiv(divToAdjust, divWithWidth) {
    try {
        var width = $(divWithWidth).width();
        var div = $(divToAdjust);
        width -= parseInt(div.css('padding-left'), 10);
        width -= parseInt(div.css('padding-right'), 10);
        width -= 1;
        $(divToAdjust).css('width', width);
    } catch (err) {

    }
}

/* 	-----------------------------------
--  JQuery UI creation methods	 --  
-----------------------------------*/
function jQueryUIInit() {
    createDatePickers();
    drawTabs();
    addMenuTab();
    jQueryUIStyling()
}

function jQueryUIStyling() {
    $('input:button:not([name^="OperationalReportViewer"]), input:submit:not(.IgnoreJQueryStyling), .ui-button, .btn').button();
    $('.webgrid-wrapper').addClass('ui-corner-all');
    $('.webgrid-title').addClass('ui-widget-header');
    jQueryTableStyling();
}

function drawTabs() {
    $("#tab-bar").tabs();
}

function createDatePickers() {

    $('.date, .hasDatePicker, .standardDate').datepicker({
        dateFormat: "dd/mm/yy",
        onSelect: function () {
            $(this).valid(); $(this).change();
        }
    });

    $('.dateWithMYSelector, .hasDatePickerWithMYSelector, .customDate').datepicker({
        dateFormat: "dd/mm/yy",
        changeMonth: true,
        changeYear: true,
        onSelect: function () {
            $(this).valid(); $(this).change();
        }
    });
}

function redrawSelectMenus() {
    $('select:not(.notdropdown):not([name^="OperationalReportViewer"])').selectmenu('destroy').selectmenu();
}

function addMenuTab() {
    $("#MenuItems").addClass('removestuff');

    $("#accordion").accordion({ active: false, collapsible: true, autoHeight: false, header: "h3" });

    $("#accordionSub").accordion({ collapsible: true, active: false, autoHeight: false, header: "h4" });

    $('.slide-out-div').tabSlideOut({
        tabHandle: '.handle',
        pathToTabImage: null,
        imageHeight: '32px',
        imageWidth: '64px',
        tabLocation: 'left',
        speed: 300,
        action: 'click',
        topPos: '100px',
        fixedPosition: false
    });


}

function jQueryTableStyling() {
    var webgrid = $('.webgrid');
    webgrid.addClass('ui-widget-content styled-table');
}


